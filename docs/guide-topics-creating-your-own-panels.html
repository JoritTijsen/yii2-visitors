<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/969a6042/css/bootstrap.css" rel="stylesheet">
<link href="./assets/f28e901f/solarized_light.css" rel="stylesheet">
<link href="./assets/43dc5993/style.css" rel="stylesheet">
<script src="./assets/6e695b5a/jquery.js"></script>
<script src="./assets/969a6042/js/bootstrap.js"></script>
<script src="./assets/7bdf3495/jssearch.js"></script>    <title>The Definitive Guide to Yii2 Visitor</title>
</head>
<body>

<div class="wrap">
    <nav id="w321" class="navbar-inverse navbar-fixed-top navbar"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w321-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">The Definitive Guide to Yii2 Visitor</a></div><div id="w321-collapse" class="collapse navbar-collapse"><ul id="w322" class="navbar-nav nav"><li><a href="./index.html">Class reference</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Extensions <span class="caret"></span></a><ul id="w323" class="dropdown-menu"><li><a href="./ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="./ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="./ext-composer-index.html" tabindex="-1">composer</a></li>
<li><a href="./ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="./ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="./ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li></ul></li>
<li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-320" data-toggle="collapse" data-parent="#navigation">Installation <b class="caret"></b></a><div id="navigation-320" class="submenu panel-collapse collapse in"></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Creating your own panels <span id="creating-your-own-panels"></span><a href="#creating-your-own-panels" class="hashlink">&para;</a></h1><p>Both the toolbar and debugger are highly configurable and customizable. To do so, you can create your own panels that collect
and display the specific data you want. Below we'll describe the process of creating a simple custom panel that:</p>
<ul>
<li>collects the views rendered during a request;</li>
<li>shows the number of views rendered in the toolbar;</li>
<li>allows you to check the view names in the debugger.</li>
</ul>
<p>The assumption is that you're using the basic project template.</p>
<p>First we need to implement the <code>Panel</code> class in <code>panels/ViewsPanel.php</code>:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">app</span>\<span class="hljs-title">panels</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">Event</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">View</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">base</span>\<span class="hljs-title">ViewEvent</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">yii</span>\<span class="hljs-title">debug</span>\<span class="hljs-title">Panel</span>;


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ViewsPanel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Panel</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$_viewFiles</span> = [];

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">parent</span>::init();
        Event::on(View::className(), View::EVENT_BEFORE_RENDER, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(ViewEvent <span class="hljs-variable">$event</span>)</span> </span>{
            <span class="hljs-variable">$this</span>-&gt;_viewFiles[] = <span class="hljs-variable">$event</span>-&gt;sender-&gt;getViewFile();
        });
    }


    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'Views'</span>;
    }

    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSummary</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-variable">$url</span> = <span class="hljs-variable">$this</span>-&gt;getUrl();
        <span class="hljs-variable">$count</span> = count(<span class="hljs-variable">$this</span>-&gt;data);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;div class=\"yii-debug-toolbar__block\"&gt;&lt;a href=\"$url\"&gt;Views &lt;span class=\"yii-debug-toolbar__label yii-debug-toolbar__label_info\"&gt;$count&lt;/span&gt;&lt;/a&gt;&lt;/div&gt;"</span>;
    }

    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDetail</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;ol&gt;&lt;li&gt;'</span> . implode(<span class="hljs-string">'&lt;/li&gt;&lt;li&gt;'</span>, <span class="hljs-variable">$this</span>-&gt;data) . <span class="hljs-string">'&lt;/li&gt;&lt;/ol&gt;'</span>;
    }

    <span class="hljs-comment">/**
     * {<span class="hljs-doctag">@inheritdoc</span>}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;_viewFiles;
    }
}
</code></pre>
<p>The workflow for the code above is:</p>
<ol>
<li><code>init</code> is executed before any controller action is run. This method is the best place to attach handlers that will collect data during the controller action's execution.</li>
<li><code>save</code> is called after controller action is executed. The data returned by this method will be stored in a data file. If nothing is returned by this method, the panel
won't be rendered.</li>
<li>The data from the data file is loaded into <code>$this-&gt;data</code>. For the toolbar, this will always represent the latest data. For the debugger, this property may be set to be read from any previous data file as well.</li>
<li>The toolbar takes its contents from <code>getSummary</code>. There, we're showing the number of view files rendered. The debugger uses
<code>getDetail</code> for the same purpose.</li>
</ol>
<p>Now it's time to tell the debugger to use the new panel. In <code>config/web.php</code>, the debug configuration is modified to:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">if</span> (YII_ENV_DEV) {
    <span class="hljs-comment">// configuration adjustments for 'dev' environment</span>
    <span class="hljs-variable">$config</span>[<span class="hljs-string">'bootstrap'</span>][] = <span class="hljs-string">'debug'</span>;
    <span class="hljs-variable">$config</span>[<span class="hljs-string">'modules'</span>][<span class="hljs-string">'debug'</span>] = [
        <span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'yii\debug\Module'</span>,
        <span class="hljs-string">'panels'</span> =&gt; [
            <span class="hljs-string">'views'</span> =&gt; [<span class="hljs-string">'class'</span> =&gt; <span class="hljs-string">'app\panels\ViewsPanel'</span>],
        ],
    ];

<span class="hljs-comment">// ...</span>
</code></pre>
<p>That's it. Now we have another useful panel without writing much code.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Wed, 15 Aug 2018 18:48:11 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script>jQuery(function ($) {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
